# Oh my ZSH setup

on_my_zsh() {
  export ZSH="${HOME}/.oh-my-zsh"
  ZSH_THEME="lssimple"
  plugins=(
      git
      brew
  )
  source $ZSH/oh-my-zsh.sh
}

aliases() {
  source "${HOME}/.bash_aliases"
}

secrets() {
  source "${HOME}/.bash_secrets"
}

completions() {  
  if type brew &>/dev/null; then
    FPATH=$(brew --prefix)/share/zsh-completions:$FPATH
  fi

  FPATH="${HOME}/.zsh:${FPATH}"

  autoload -Uz compinit
  compinit -u
  
  autoload -U +X bashcompinit && bashcompinit
}

editor() {
  # === Editor Setup ===
  export EDITOR="vim"
  export VIMINIT="source ${HOME}/.vimrc"
}

setup_asdf() {
  . "$(brew --prefix asdf)/libexec/asdf.sh"
  . "$(brew --prefix asdf)/etc/bash_completion.d/asdf.bash"

  # required for nodejs install to work
  export NODEJS_CHECK_SIGNATURES=no
}

setup_deno() {
  export PATH="${HOME}/.deno/bin:${PATH}"
}

cd_enhanced() {
  builtin cd "$@"
  use_envrc
  use_asdf
}

setup_rust() {
  . "$HOME/.cargo/env"
}

setup_coursier() {
  export PATH="$PATH:${HOME}/Library/Application Support/Coursier/bin"
}

export PATH="/usr/local/sbin:${PATH}"
export TERM=xterm-256color

on_my_zsh
secrets
aliases
completions
editor
setup_asdf
setup_deno
use_envrc
use_asdf
setup_rust
setup_coursier

alias cd="cd_enhanced"

eval "$(starship init zsh)"